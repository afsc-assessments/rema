<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Strategies for handling zero biomass observations • rema</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Strategies for handling zero biomass observations">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rema</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/ex1_basics.html">REMA basics</a></li>
    <li><a class="dropdown-item" href="../articles/ex2_cpue.html">Fitting to an additional CPUE survey</a></li>
    <li><a class="dropdown-item" href="../articles/ex3_zeros.html">Strategies for handling zero biomass observations</a></li>
    <li><a class="dropdown-item" href="../articles/ex4_model_validation.html">REMA model validation</a></li>
    <li><a class="dropdown-item" href="../articles/rema_equations.html">REMA model equations</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/JaneSullivan-NOAA/rema/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Strategies for handling zero biomass observations</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/JaneSullivan-NOAA/rema/blob/main/vignettes/ex3_zeros.Rmd" class="external-link"><code>vignettes/ex3_zeros.Rmd</code></a></small>
      <div class="d-none name"><code>ex3_zeros.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/JaneSullivan-NOAA/rema" class="external-link">rema</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/" class="external-link">cowplot</a></span><span class="op">)</span> <span class="co"># install.packages('cowplot') # helpful plotting utilities</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/theme_cowplot.html" class="external-link">theme_cowplot</a></span><span class="op">(</span>font_size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span> <span class="op">+</span></span>
<span>                     <span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/background_grid.html" class="external-link">background_grid</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>                     <span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/panel_border.html" class="external-link">panel_border</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>A zero biomass observation occurs when a species is not detected in a
survey strata, resulting in an estimated biomass equal to zero and no
estimate of variance. These zeros are problematic in the REMA model
because biomass is estimated in log-space, and therefore cannot handle
zeros. Currently, the default method in REMA is to treat zeros as NAs,
or missing values. The REMA package contains alternative methods that
allow easy exploration of zero assumptions, including an option to add a
user-defined constant (default small constant = 0.0001) and manually
define a CV for the zero values (default CV = 1.5).</p>
<p>Here we compare these alternatives with a third, experimental method,
using the Tweedie distribution to model observation errors. The Tweedie
distribution is a positive, continuous distribution that accepts zeros
and is therefore an ideal candidate for situations with zero biomass
observations. The tradeoffs of this situation is that it requires the
estimation of another parameter (the power parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ρ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>),
is computationally expensive, and at least in trial runs, appears to
suffer from convergence issues.</p>
<p>The following example uses BSAI non-shortspine thornyhead (non-SST)
other rockfish in the EBS shelf bottom trawl survey. The time series of
biomass has 13 zeros out of 38 total observations.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">nonsst</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">'ebsshelf_orox_biomass.csv'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">nonsst</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">strata</th>
<th align="right">year</th>
<th align="right">biomass</th>
<th align="right">cv</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">EBS Shelf</td>
<td align="right">1982</td>
<td align="right">0.00</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">EBS Shelf</td>
<td align="right">1983</td>
<td align="right">0.00</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">EBS Shelf</td>
<td align="right">1984</td>
<td align="right">17.75</td>
<td align="right">1.0001177</td>
</tr>
<tr class="even">
<td align="left">EBS Shelf</td>
<td align="right">1985</td>
<td align="right">36.17</td>
<td align="right">0.9999791</td>
</tr>
<tr class="odd">
<td align="left">EBS Shelf</td>
<td align="right">1986</td>
<td align="right">0.00</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">EBS Shelf</td>
<td align="right">1987</td>
<td align="right">49.72</td>
<td align="right">0.9999973</td>
</tr>
<tr class="odd">
<td align="left">EBS Shelf</td>
<td align="right">1988</td>
<td align="right">0.00</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">EBS Shelf</td>
<td align="right">1989</td>
<td align="right">0.00</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">EBS Shelf</td>
<td align="right">1990</td>
<td align="right">0.00</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">EBS Shelf</td>
<td align="right">1991</td>
<td align="right">857.40</td>
<td align="right">0.9427366</td>
</tr>
<tr class="odd">
<td align="left">EBS Shelf</td>
<td align="right">1992</td>
<td align="right">13.75</td>
<td align="right">0.9996411</td>
</tr>
<tr class="even">
<td align="left">EBS Shelf</td>
<td align="right">1993</td>
<td align="right">86.07</td>
<td align="right">1.0000160</td>
</tr>
<tr class="odd">
<td align="left">EBS Shelf</td>
<td align="right">1994</td>
<td align="right">46.61</td>
<td align="right">0.9999849</td>
</tr>
<tr class="even">
<td align="left">EBS Shelf</td>
<td align="right">1995</td>
<td align="right">75.58</td>
<td align="right">0.7025223</td>
</tr>
<tr class="odd">
<td align="left">EBS Shelf</td>
<td align="right">1996</td>
<td align="right">35.63</td>
<td align="right">0.9999759</td>
</tr>
<tr class="even">
<td align="left">EBS Shelf</td>
<td align="right">1997</td>
<td align="right">126.24</td>
<td align="right">0.9999773</td>
</tr>
<tr class="odd">
<td align="left">EBS Shelf</td>
<td align="right">1998</td>
<td align="right">537.59</td>
<td align="right">0.6792890</td>
</tr>
<tr class="even">
<td align="left">EBS Shelf</td>
<td align="right">1999</td>
<td align="right">397.58</td>
<td align="right">0.7501752</td>
</tr>
<tr class="odd">
<td align="left">EBS Shelf</td>
<td align="right">2000</td>
<td align="right">0.00</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">EBS Shelf</td>
<td align="right">2001</td>
<td align="right">0.00</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">EBS Shelf</td>
<td align="right">2002</td>
<td align="right">0.00</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">EBS Shelf</td>
<td align="right">2003</td>
<td align="right">55.35</td>
<td align="right">0.6986692</td>
</tr>
<tr class="odd">
<td align="left">EBS Shelf</td>
<td align="right">2004</td>
<td align="right">0.00</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">EBS Shelf</td>
<td align="right">2005</td>
<td align="right">36.32</td>
<td align="right">1.0000123</td>
</tr>
<tr class="odd">
<td align="left">EBS Shelf</td>
<td align="right">2006</td>
<td align="right">356.64</td>
<td align="right">0.8470749</td>
</tr>
<tr class="even">
<td align="left">EBS Shelf</td>
<td align="right">2007</td>
<td align="right">0.00</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">EBS Shelf</td>
<td align="right">2008</td>
<td align="right">0.00</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">EBS Shelf</td>
<td align="right">2009</td>
<td align="right">121.56</td>
<td align="right">0.5781683</td>
</tr>
<tr class="odd">
<td align="left">EBS Shelf</td>
<td align="right">2010</td>
<td align="right">56.95</td>
<td align="right">0.9201803</td>
</tr>
<tr class="even">
<td align="left">EBS Shelf</td>
<td align="right">2011</td>
<td align="right">55.82</td>
<td align="right">1.0000285</td>
</tr>
<tr class="odd">
<td align="left">EBS Shelf</td>
<td align="right">2012</td>
<td align="right">36.63</td>
<td align="right">1.0000276</td>
</tr>
<tr class="even">
<td align="left">EBS Shelf</td>
<td align="right">2013</td>
<td align="right">39.73</td>
<td align="right">1.0001188</td>
</tr>
<tr class="odd">
<td align="left">EBS Shelf</td>
<td align="right">2014</td>
<td align="right">28.25</td>
<td align="right">0.9999542</td>
</tr>
<tr class="even">
<td align="left">EBS Shelf</td>
<td align="right">2015</td>
<td align="right">142.91</td>
<td align="right">0.9999827</td>
</tr>
<tr class="odd">
<td align="left">EBS Shelf</td>
<td align="right">2016</td>
<td align="right">20.06</td>
<td align="right">0.9997865</td>
</tr>
<tr class="even">
<td align="left">EBS Shelf</td>
<td align="right">2017</td>
<td align="right">169.32</td>
<td align="right">0.7267037</td>
</tr>
<tr class="odd">
<td align="left">EBS Shelf</td>
<td align="right">2018</td>
<td align="right">1592.69</td>
<td align="right">0.6999401</td>
</tr>
<tr class="even">
<td align="left">EBS Shelf</td>
<td align="right">2019</td>
<td align="right">0.00</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
<div class="section level2">
<h2 id="model-1-zeros-as-nas">Model 1: Zeros as NAs<a class="anchor" aria-label="anchor" href="#model-1-zeros-as-nas"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">nonsst</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">'ebsshelf_orox_biomass.csv'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">input1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_rema_input.html">prepare_rema_input</a></span><span class="op">(</span>model_name <span class="op">=</span> <span class="st">'M1: Zeros as NAs'</span>,</span>
<span>                             biomass_dat <span class="op">=</span> <span class="va">nonsst</span>,</span>
<span>                             zeros <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>assumption <span class="op">=</span> <span class="st">'NA'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_rema.html">fit_rema</a></span><span class="op">(</span><span class="va">input1</span><span class="op">)</span></span>
<span><span class="co">#&gt; Model runtime: 0.1 seconds </span></span>
<span><span class="co">#&gt; stats::nlminb thinks the model has converged: mod$opt$convergence == 0</span></span>
<span><span class="co">#&gt; Maximum gradient component: 4.23e-10 </span></span>
<span><span class="co">#&gt; Max gradient parameter: log_PE </span></span>
<span><span class="co">#&gt; TMB:sdreport() was performed successfully for this model</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="model-2-add-a-small-constant">Model 2: Add a small constant<a class="anchor" aria-label="anchor" href="#model-2-add-a-small-constant"></a>
</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">input2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_rema_input.html">prepare_rema_input</a></span><span class="op">(</span>model_name <span class="op">=</span> <span class="st">'M2: Small constant=0.01, CV=1.5'</span>,</span>
<span>                            biomass_dat <span class="op">=</span> <span class="va">nonsst</span>,</span>
<span>                            zeros <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>assumption <span class="op">=</span> <span class="st">'small_constant'</span>,</span>
<span>                                         <span class="co"># values: 1) small constant, 2) assumed CV</span></span>
<span>                                         options_small_constant <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">1.5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_rema.html">fit_rema</a></span><span class="op">(</span><span class="va">input2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Model runtime: 0.1 seconds </span></span>
<span><span class="co">#&gt; stats::nlminb thinks the model has converged: mod$opt$convergence == 0</span></span>
<span><span class="co">#&gt; Maximum gradient component: 1.33e-07 </span></span>
<span><span class="co">#&gt; Max gradient parameter: log_PE </span></span>
<span><span class="co">#&gt; TMB:sdreport() was performed successfully for this model</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="model-3-tweedie-distribution">Model 3: Tweedie distribution<a class="anchor" aria-label="anchor" href="#model-3-tweedie-distribution"></a>
</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">input3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_rema_input.html">prepare_rema_input</a></span><span class="op">(</span>model_name <span class="op">=</span> <span class="st">'M3: Tweedie'</span>,</span>
<span>                             biomass_dat <span class="op">=</span> <span class="va">nonsst</span>,</span>
<span>                             zeros <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>assumption <span class="op">=</span> <span class="st">'tweedie'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_rema.html">fit_rema</a></span><span class="op">(</span><span class="va">input3</span><span class="op">)</span></span>
<span><span class="co">#&gt; Model runtime: 0.1 seconds </span></span>
<span><span class="co">#&gt; stats::nlminb thinks the model has converged: mod$opt$convergence == 0</span></span>
<span><span class="co">#&gt; Maximum gradient component: 1.72e-10 </span></span>
<span><span class="co">#&gt; Max gradient parameter: log_PE </span></span>
<span><span class="co">#&gt; TMB:sdreport() was performed successfully for this model</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="compare-model-results">Compare model results<a class="anchor" aria-label="anchor" href="#compare-model-results"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">compare</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compare_rema_models.html">compare_rema_models</a></span><span class="op">(</span>rema_models <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">m1</span>, <span class="va">m2</span>, <span class="va">m3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">compare</span><span class="op">$</span><span class="va">plots</span><span class="op">$</span><span class="va">biomass_by_strata</span></span></code></pre></div>
<p><img src="ex3_zeros_files/figure-html/compare-1.png" width="816"></p>
<p>Models 1 (Zeros as NAs) and 3 (Tweedie) have the most similar
results. While the Tweedie appears to perform well in this case, it can
be very slow to run and suffer from convergence issues, especially when
observation errors are relatively small. The Tweedie alternative should
be considered experimental until these issues can be resolved.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jane Sullivan, Laurinne Balstad.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
