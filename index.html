<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>A generalized framework to fit the random effects (RE) model, a state-space random walk model developed at the Alaska Fisheries Science Center (AFSC) for apportionment and biomass estimation of groundfish and crab stocks. • rema</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="A generalized framework to fit the random effects (RE) model, a state-space random walk model developed at the Alaska Fisheries Science Center (AFSC) for apportionment and biomass estimation of groundfish and crab stocks.">
<meta name="description" content="This package provides a generalized framework to fit the random effects (RE) model, a state-space random walk model developed at the Alaska Fisheries Science Center (AFSC) for smoothing survey biomass estimates and apportioning catch among management areas. REMA is a multivariate extension of the original single-survey, single-strata RE model that allows the use of multiple strata within a survey and an additional survey (e.g. CPUE or relative population numbers) to inform the biomass trend (Hulson et al. 2021). If multi-survey mode is turned off, REMA runs the same as the univariate (RE) and multivariate (i.e. multiple area or depth strata; REM) versions of the model. REMA was developed in Template Model Builder (TMB; Kristensen et al. 2016).">
<meta property="og:description" content="This package provides a generalized framework to fit the random effects (RE) model, a state-space random walk model developed at the Alaska Fisheries Science Center (AFSC) for smoothing survey biomass estimates and apportioning catch among management areas. REMA is a multivariate extension of the original single-survey, single-strata RE model that allows the use of multiple strata within a survey and an additional survey (e.g. CPUE or relative population numbers) to inform the biomass trend (Hulson et al. 2021). If multi-survey mode is turned off, REMA runs the same as the univariate (RE) and multivariate (i.e. multiple area or depth strata; REM) versions of the model. REMA was developed in Template Model Builder (TMB; Kristensen et al. 2016).">
<meta property="og:image" content="https://afsc-assessments.github.io/rema/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">rema</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/ex1_basics.html">REMA basics</a></li>
    <li><a class="dropdown-item" href="articles/ex2_cpue.html">Fitting to an additional CPUE survey</a></li>
    <li><a class="dropdown-item" href="articles/ex3_zeros.html">Strategies for handling zero biomass observations</a></li>
    <li><a class="dropdown-item" href="articles/ex4_model_validation.html">REMA model validation</a></li>
    <li><a class="dropdown-item" href="articles/rema_equations.html">REMA model equations</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/JaneSullivan-NOAA/rema/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="rema-">REMA <a class="anchor" aria-label="anchor" href="#rema-"></a>
</h1>
</div>
<div class="section level3">
<h3 id="a-generalized-random-effects-model-for-fitting-survey-biomass-estimates-with-the-options-of-including-multiple-survey-strata-and-an-additional-survey-index">A generalized Random Effects model for fitting survey biomass estimates with the options of including Multiple survey strata and an Additional survey index<a class="anchor" aria-label="anchor" href="#a-generalized-random-effects-model-for-fitting-survey-biomass-estimates-with-the-options-of-including-multiple-survey-strata-and-an-additional-survey-index"></a>
</h3>
<p>Sullivan, J., C. Monnahan, P. Hulson, J. Ianelli, J. Thorson, and A. Havron. 2022a. REMA: a consensus version of the random effects model for ABC apportionment and Tier 4/5 assessments. Plan Team Report, Joint Groundfish Plan Teams, North Pacific Fishery Management Council. 605 W 4th Ave, Suite 306 Anchorage, AK 99501. <a href="https://meetings.npfmc.org/CommentReview/DownloadFile?p=eaa760cf-8a4e-4c05-aa98-82615da1982a.pdf&amp;fileName=Tier%204_5%20Random%20Effects.pdf" class="external-link">Available through the Oct 2022 Joint GPT e-Agenda</a>.</p>
<p>Living documentation for REMA model equations is available on the REMA website: <a href="https://afsc-assessments.github.io/rema/articles/rema_equations.html" class="uri">https://afsc-assessments.github.io/rema/articles/rema_equations.html</a></p>
</div>
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p>The random effects (RE) model was developed by the North Pacific Fisheries Management Council (NPFMC) Groundfish Plan Team’s Survey Averaging working group and has been used at the Alaska Fisheries Science Center (AFSC) since <a href="https://github.com/afsc-assessments/SurveyAverageRandomEffects/blob/013c9a937fa0133f594c7d66248677685ae77010/code/re.tpl" class="external-link">2013</a> to estimate biomass in data-limited groundfish and crab stock assessments, and to apportion catch among management areas. The RE model estimates biomass as a series of random effects and the underlying state dynamics are modeled as a random walk (<a href="https://meetings.npfmc.org/CommentReview/DownloadFile?p=11009549-068b-40cf-903d-67f90686db60.pdf&amp;fileName=C4%20c1%20Joint%20Plan%20Team%20Minutes.pdf" class="external-link">Oct 2013 Joint GPT minutes</a>).</p>
<p>There are several versions of the original single-strata (univariate) RE and the single-survey, multiple-strata (multivariate; REM) models currently in use at the AFSC. The RE and REM models were further extended in 2017 to include the addition of a second relative index of abundance (e.g., NMFS longline survey Relative Population Numbers) to inform the biomass trend through the estimation of additional scaling parameters (REMA; <a href="https://repository.library.noaa.gov/view/noaa/28174" class="external-link">Hulson et al. 2021</a>). Although the RE, REM, and REMA models share the same underlying state-space and random walk dynamics, <a href="https://meetings.npfmc.org/CommentReview/DownloadFile?p=86098951-a0ed-4021-a4e1-95abe5a357fe.pdf&amp;fileName=Tiers%204%20and%205%20assessment%20considerations.pdf" class="external-link">Monnahan et al. (2021)</a> found inconsistencies in the treatment of zero biomass observations, use of a prior or penalty on the process error parameter, and weighting of the observation error likelihood components.</p>
<p>The purpose of the <code>rema</code> R library is to provide a unified random effects model that is flexible enough to accommodate the multitude of use cases at the AFSC. As presented here, the REMA model is generalized to include the RE and REM and allows users to quickly develop and evaluate more complex models or alternative parameterizations. The variable names have been updated from their original versions to increase interpretability and transparency, and the model has been rewritten in Template Model Builder (TMB; <a href="https://www.jstatsoft.org/article/view/v070i05" class="external-link">Kristensen et al. 2016</a>). Additionally, <code>rema</code> provides a flexible framework to do the following analyses:</p>
<ol style="list-style-type: decimal">
<li><p>Compare and bridge existing <code>ADMB</code> models currently used for Tiers 4 and 5 stock assessments and Tier 3 apportionment to REMA;</p></li>
<li><p>Visualize multiple model results simultaneously and conduct model selection when appropriate using Akaike Information Criteria (AIC);</p></li>
<li><p>Analyze alternative approaches to handling zero biomass observations, including treating zeros as missing values or failed surveys, adding a small constant to zero values and manually defining the associated coefficient of variation for these values, or exploring an experimental option to model these observations using the Tweedie distribution, a positive, continuous distribution that accommodates zeros;</p></li>
<li><p>Perform model validation using appropriate diagnostic tools for latent variable models [e.g., reporting convergence criteria and conducting a one-step-ahead (OSA) residual analysis];</p></li>
<li><p>Evaluate the use of priors on process error and scaling parameter parameters, along with alternative likelihood penalties.</p></li>
</ol>
<p>The structure, naming conventions, functions, and documentation in <code>rema</code> were inspired by and modeled after the Woods Hole Assessment Model (<a href="https://timjmiller.github.io/wham/" class="external-link">WHAM</a>; Miller and Stock 2020), an open-source, state-space age-structured assessment model and R package.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Use the <code>devtools</code> package to install the <code>rema</code> package from github. If you do not have <code>devtools</code> installed, you must do that first.</p>
<pre><code><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"afsc-assessments/rema"</span>, dependencies <span class="op">=</span> <span class="cn">TRUE</span>, build_vignettes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Example R scripts are downloaded when `rema` is installed. Locate them on your computer by running the following commands:</span></span>
<span><span class="op">(</span><span class="va">rema_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/find.package.html" class="external-link">find.package</a></span><span class="op">(</span><span class="st">'rema'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">rema_examples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">rema_path</span>, <span class="st">'example_scripts'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">rema_examples</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Vignettes</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/JaneSullivan-NOAA/rema" class="external-link">rema</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/browseVignettes.html" class="external-link">browseVignettes</a></span><span class="op">(</span><span class="st">"rema"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span>topic <span class="op">=</span> <span class="st">"rema_equations"</span><span class="op">)</span> <span class="co"># view technical details offline</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span>topic <span class="op">=</span> <span class="st">"ex1_basics"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span>topic <span class="op">=</span> <span class="st">"ex2_cpue"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span>topic <span class="op">=</span> <span class="st">"ex3_zeros"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span>topic <span class="op">=</span> <span class="st">"ex4_model_validation"</span><span class="op">)</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="the-rema-worflow">The <code>rema</code> worflow<a class="anchor" aria-label="anchor" href="#the-rema-worflow"></a>
</h2>
<ol style="list-style-type: decimal">
<li><p>Load <code>rema</code> and data. The user can read biomass or other abundance index data from file (e.g. csv files), or they can use the <code>rwout.rep</code> report file from the ADMB version of the RE model using <code><a href="reference/read_admb_re.html">read_admb_re()</a></code>.</p></li>
<li><p>Define the model structure and assumptions using <code><a href="reference/prepare_rema_input.html">prepare_rema_input()</a></code>. This function allows users to quickly transition from a single to two survey model, specify alternative process error structures, add likelihood penalties or priors on parameters, and evaluate alternative assumptions about zero biomass observations.</p></li>
<li><p>Fit the specified REMA model using <code><a href="reference/fit_rema.html">fit_rema()</a></code> and determine whether the model has met basic convergence criteria.</p></li>
<li><p>Extract <code>rema</code> model output into clean, consistently formatted data frames using <code><a href="reference/tidy_rema.html">tidy_rema()</a></code>. The user can visualize this model output using <code><a href="reference/plot_rema.html">plot_rema()</a></code>, or quickly format it into tables for a report.</p></li>
<li><p>Compare alternative REMA models and conduct model selection using <code><a href="reference/compare_rema_models.html">compare_rema_models()</a></code>. Output from this function includes a table of Akaike Information Criteria (AIC) when appropriate, figures, and tidied data frames. This function also accepts model output from the ADMB version of the RE model for easy comparison to past models.</p></li>
</ol>
<p>Taken together, these functions allow R users to quickly fit and interrogate a suite of simple statistical models in TMB without needing software-specific training or expertise.</p>
</div>
</div>
  </main><aside class="col-md-3"><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/JaneSullivan-NOAA/rema/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/JaneSullivan-NOAA/rema/issues" class="external-link">Report a bug</a></li>
</ul>
</div>


  </aside></aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jane Sullivan, Laurinne Balstad.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
